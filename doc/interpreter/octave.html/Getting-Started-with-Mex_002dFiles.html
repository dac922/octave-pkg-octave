<html lang="en">
<head>
<title>Getting Started with Mex-Files - GNU Octave</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU Octave">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Mex_002dFiles.html#Mex_002dFiles" title="Mex-Files">
<link rel="next" href="Working-with-Matrices-and-Arrays-in-Mex_002dFiles.html#Working-with-Matrices-and-Arrays-in-Mex_002dFiles" title="Working with Matrices and Arrays in Mex-Files">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Getting-Started-with-Mex-Files"></a>
<a name="Getting-Started-with-Mex_002dFiles"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Working-with-Matrices-and-Arrays-in-Mex_002dFiles.html#Working-with-Matrices-and-Arrays-in-Mex_002dFiles">Working with Matrices and Arrays in Mex-Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Mex_002dFiles.html#Mex_002dFiles">Mex-Files</a>
<hr>
</div>

<h4 class="subsection">A.2.1 Getting Started with Mex-Files</h4>

<p>The basic command to build a mex-file is either <code>mkoctfile --mex</code>
or <code>mex</code>.  The first command can be used either from within Octave or from
the command line.  However, to avoid issues with <span class="sc">matlab</span>'s own <code>mex</code>
command, the use of the command <code>mex</code> is limited to within Octave. 
Compiled mex-files have the extension <samp><span class="file">.mex</span></samp>.

<!-- mex scripts/miscellaneous/mex.m -->
   <p><a name="XREFmex"></a>

<div class="defun">
&mdash; Command:  <b>mex</b> [<var>options</var>]<var> file <small class="dots">...</small><a name="index-mex-3942"></a></var><br>
<blockquote><p>Compile source code written in C, C++, or Fortran, to a MEX file. 
This is equivalent to <code>mkoctfile --mex [options] file</code>.

     <p class="noindent"><strong>See also:</strong> <a href="XREFmkoctfile.html#XREFmkoctfile">mkoctfile</a>.

        </blockquote></div>

<!-- mexext scripts/miscellaneous/mexext.m -->
   <p><a name="XREFmexext"></a>

<div class="defun">
&mdash; Function File:  <b>mexext</b> ()<var><a name="index-mexext-3943"></a></var><br>
<blockquote><p>Return the filename extension used for MEX files.

     <p class="noindent"><strong>See also:</strong> <a href="XREFmex.html#XREFmex">mex</a>.

        </blockquote></div>

   <p>Consider the following short example:

<pre class="example"><pre class="verbatim">     #include "mex.h"
     
     void
     mexFunction (int nlhs, mxArray *plhs[],
                  int nrhs, const mxArray *prhs[])
     {
       mexPrintf ("Hello, World!\n");
     
       mexPrintf ("I have %d inputs and %d outputs\n", nrhs, nlhs);
     }
</pre>
</pre>
   <p>The first line <code>#include "mex.h"</code> makes available all of the definitions
necessary for a mex-file.  One important difference between Octave and
<span class="sc">matlab</span> is that the header file <code>"matrix.h"</code> is implicitly included
through the inclusion of <code>"mex.h"</code>.  This is necessary to avoid a conflict
with the Octave file <code>"Matrix.h"</code> for operating systems and compilers that
don't distinguish between filenames in upper and lower case.

   <p>The entry point into the mex-file is defined by <code>mexFunction</code>.  The
function takes four arguments:

     <ol type=1 start=1>
<li>The number of return arguments (# of left-hand side args).

     <li>An array of pointers to return arguments.

     <li>The number of input arguments (# of right-hand side args).

     <li>An array of pointers to input arguments.
        </ol>

   <p>Note that the function name definition is not explicitly included in
<code>mexFunction</code> and so there can only be a single <code>mexFunction</code>
entry point per file.  Instead, the name of the function as seen in Octave is
determined by the name of the mex-file itself minus the extension.  Therefore,
if the above function is in the file <samp><span class="file">myhello.c</span></samp>, it can be compiled with

<pre class="example">     mkoctfile --mex myhello.c
</pre>
   <p class="noindent">which creates a file <samp><span class="file">myhello.mex</span></samp>.  The function can then be run from
Octave as

<pre class="example">     myhello (1,2,3)
     &rArr; Hello, World!
     &rArr; I have 3 inputs and 0 outputs
</pre>
   <p>It should be noted that the mex-file contains no help string for the
functions it contains.  To document mex-files, there should exist an
m-file in the same directory as the mex-file itself.  Taking the above as
an example, we would therefore have a file <samp><span class="file">myhello.m</span></samp> that might
contain the text

<pre class="example">     %MYHELLO Simple test of the functionality of a mex-file.
</pre>
   <p>In this case, the function that will be executed within Octave will be
given by the mex-file, while the help string will come from the
m-file.  This can also be useful to allow a sample implementation of the
mex-file within the Octave language itself for testing purposes.

   <p>Although there cannot be multiple entry points in a single mex-file,
one can use the <code>mexFunctionName</code> function to determine what name
the mex-file was called with.  This can be used to alter the behavior of
the mex-file based on the function name.  For example, if

<pre class="example"><pre class="verbatim">     #include "mex.h"
     
     void
     mexFunction (int nlhs, mxArray *plhs[],
                  int nrhs, const mxArray *prhs[])
     {
       const char *nm;
     
       nm = mexFunctionName ();
       mexPrintf ("You called function: %s\n", nm);
       if (strcmp (nm, "myfunc") == 0)
         mexPrintf ("This is the principal function\n", nm);
     
       return; 
     }
</pre>
</pre>
   <p class="noindent">is in file <samp><span class="file">myfunc.c</span></samp>, and it is compiled with

<pre class="example">     mkoctfile --mex myfunc.c
     ln -s myfunc.mex myfunc2.mex
</pre>
   <p class="noindent">then as can be seen by

<pre class="example">     myfunc ()
     &rArr; You called function: myfunc
         This is the principal function
     myfunc2 ()
     &rArr; You called function: myfunc2
</pre>
   <p class="noindent">the behavior of the mex-file can be altered depending on the functions
name.

   <p>Although the user should only include <samp><span class="file">mex.h</span></samp> in their code, Octave
declares additional functions, typedefs, etc., available to the user to
write mex-files in the headers <samp><span class="file">mexproto.h</span></samp> and <samp><span class="file">mxarray.h</span></samp>.

   </body></html>

